<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>ğŸ’Œ</title>

<style>
html, body {
  margin: 0;
  width: 100%;
  height: 100%;
  overflow: hidden;
  font-family: Arial, cursive;
}

body {
  background: linear-gradient(270deg, #ff1e56, #ff4d6d, #ff85a2);
  background-size: 600% 600%;
  animation: fundo 8s ease infinite;
}

@keyframes fundo {
  0% { background-position: 0% 50% }
  50% { background-position: 100% 50% }
  100% { background-position: 0% 50% }
}

#mensagem {
  position: absolute;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  text-align: center;
  color: #fff;
  font-size: 24px;
  padding: 20px;
  text-shadow: 0 0 20px rgba(255,255,255,.8);
  opacity: 0;
  transition: opacity .6s ease;
  z-index: 2;
}

canvas {
  position: absolute;
  inset: 0;
  z-index: 3;
}

/* CoraÃ§Ãµes */
.heart {
  position: absolute;
  color: red;
  animation: subir 5s linear infinite;
  opacity: .85;
}

@keyframes subir {
  from { transform: translateY(100vh) scale(.6); opacity: 0 }
  to { transform: translateY(-10vh) scale(1.2); opacity: 1 }
}
</style>
</head>

<body>

<div id="mensagem">
  ğŸ’ŒğŸ¥º<br><br>
  Eu tÃ´ com muita saudade<br>
  das suas mensagensâ€¦<br><br>
  Elas fazem falta no meu dia,<br>
  e vocÃª tambÃ©m ğŸ’–<br><br>
  â¤ï¸âœ¨
</div>

<canvas id="raspa"></canvas>

<script>
const canvas = document.getElementById("raspa");
const ctx = canvas.getContext("2d");
const msg = document.getElementById("mensagem");

function resize(){
  const dpr = window.devicePixelRatio || 1;
  canvas.width = innerWidth * dpr;
  canvas.height = innerHeight * dpr;
  canvas.style.width = innerWidth + "px";
  canvas.style.height = innerHeight + "px";
  ctx.setTransform(dpr,0,0,dpr,0,0);
  ctx.fillStyle = "#f2f2f2";
  ctx.fillRect(0,0,innerWidth,innerHeight);
}
resize();
addEventListener("resize", resize);

let ativo = false;
let liberado = false;

function apagar(x,y){
  ctx.globalCompositeOperation = "destination-out";
  ctx.beginPath();
  ctx.arc(x,y,65,0,Math.PI*2);
  ctx.fill();
  verificar();
}

canvas.addEventListener("touchstart", ()=>ativo=true);
canvas.addEventListener("touchend", ()=>ativo=false);
canvas.addEventListener("touchmove", e=>{
  if(!ativo || liberado) return;
  const t = e.touches[0];
  apagar(t.clientX, t.clientY);
});

function verificar(){
  const img = ctx.getImageData(0,0,canvas.width,canvas.height).data;
  let transparente = 0, total = 0;
  for(let i=3;i<img.length;i+=40){
    total++;
    if(img[i] === 0) transparente++;
  }
  if(transparente / total > 0.18 && !liberado){
    liberar();
  }
}

function liberar(){
  liberado = true;
  msg.style.opacity = 1;
  canvas.style.display = "none";
}

// CoraÃ§Ãµes subindo
setInterval(()=>{
  const h = document.createElement("div");
  h.className = "heart";
  h.innerHTML = "â¤ï¸";
  h.style.left = Math.random()*100 + "vw";
  h.style.fontSize = (18 + Math.random()*30) + "px";
  document.body.appendChild(h);
  setTimeout(()=>h.remove(),5000);
}, 350);
</script>

</body>
</html>